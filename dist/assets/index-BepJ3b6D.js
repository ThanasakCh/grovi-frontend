import{g as ne,a as ie}from"./index-zGQrujfl.js";function ae(e,i){for(var a=0;a<i.length;a++){const n=i[a];if(typeof n!="string"&&!Array.isArray(n)){for(const f in n)if(f!=="default"&&!(f in e)){const T=Object.getOwnPropertyDescriptor(n,f);T&&Object.defineProperty(e,f,T.get?T:{enumerable:!0,get:()=>n[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var re="2.0.3",oe=[].slice,se={};function N(e){if(!(e>=1))throw new Error;this._size=e,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}N.prototype=Z.prototype={constructor:N,defer:function(e){if(typeof e!="function"||this._call)throw new Error;if(this._error!=null)return this;var i=oe.call(arguments,1);return i.push(e),++this._waiting,this._tasks.push(i),$(this),this},abort:function(){return this._error==null&&R(this,new Error("abort")),this},await:function(e){if(typeof e!="function"||this._call)throw new Error;return this._call=function(i,a){e.apply(null,[i].concat(a))},C(this),this},awaitAll:function(e){if(typeof e!="function"||this._call)throw new Error;return this._call=e,C(this),this}};function $(e){if(!e._start)try{ce(e)}catch(i){e._tasks[e._ended+e._active-1]&&R(e,i)}}function ce(e){for(;e._start=e._waiting&&e._active<e._size;){var i=e._ended+e._active,a=e._tasks[i],n=a.length-1,f=a[n];a[n]=ue(e,i),--e._waiting,++e._active,a=f.apply(null,a),e._tasks[i]&&(e._tasks[i]=a||se)}}function ue(e,i){return function(a,n){e._tasks[i]&&(--e._active,++e._ended,e._tasks[i]=null,e._error==null&&(a!=null?R(e,a):(e._data[i]=n,e._waiting?$(e):C(e))))}}function R(e,i){var a=e._tasks.length,n;for(e._error=i,e._data=void 0,e._waiting=NaN;--a>=0;)if((n=e._tasks[a])&&(e._tasks[a]=null,n.abort))try{n.abort()}catch{}e._active=NaN,C(e)}function C(e){!e._active&&e._call&&e._call(e._error,e._data)}function Z(e){return new N(arguments.length?+e:1/0)}const fe=Object.freeze(Object.defineProperty({__proto__:null,queue:Z,version:re},Symbol.toStringTag,{value:"Module"})),le=ne(fe);var S,Q;function de(){if(Q)return S;Q=1;var e=le.queue,i=+new Date;return S=function(n,f){var T=!!L.mapbox,l=n.getSize(),v=new e(1),I=document.createElement("canvas");I.width=l.x,I.height=l.y;var G=I.getContext("2d"),P=document.createElement("canvas");P.width=1,P.height=1;var A=P.getContext("2d");if(A.fillStyle="rgba(0,0,0,0)",A.fillRect(0,0,1,1),n.eachLayer(H),n.eachLayer(K),n._pathRoot)v.defer(O,n._pathRoot);else if(n._panes){var U=n._panes.overlayPane.getElementsByTagName("canvas").item(0);U&&v.defer(O,U)}n.eachLayer(J),v.awaitAll(W);function H(t){t instanceof L.TileLayer?v.defer(X,t):t._heat&&v.defer(O,t._canvas)}function J(t){t instanceof L.Marker&&t.options.icon instanceof L.Icon&&v.defer(Y,t)}function K(t){L.esri&&t instanceof L.esri.DynamicMapLayer&&v.defer(q,t)}function V(){f(null,I)}function W(t,u){if(t)throw t;u.forEach(function(r){r&&r.canvas&&G.drawImage(r.canvas,0,0)}),V()}function X(t,u){var r=L.TileLayer.Canvas&&t instanceof L.TileLayer.Canvas,d=document.createElement("canvas");d.width=l.x,d.height=l.y;var s=d.getContext("2d"),m=n.getPixelBounds(),g=n.getZoom(),h=t.options.tileSize;if(g>t.options.maxZoom||g<t.options.minZoom||T&&t instanceof L.mapbox.tileLayer&&!t.options.tiles)return u();var p=L.bounds(m.min.divideBy(h)._floor(),m.max.divideBy(h)._floor()),y=[],w,c,b=new e(1);for(w=p.min.y;w<=p.max.y;w++)for(c=p.min.x;c<=p.max.x;c++)y.push(new L.Point(c,w));y.forEach(function(o){var _=o.clone();t._adjustTilePoint&&t._adjustTilePoint(o);var x=_.scaleBy(new L.Point(h,h)).subtract(m.min);if(o.y>=0)if(r){var E=t._tiles[o.x+":"+o.y];b.defer(B,E,x,h)}else{var z=M(t.getTileUrl(o));b.defer(j,z,x,h)}}),b.awaitAll(D);function B(o,_,x,E){E(null,{img:o,pos:_,size:x})}function j(o,_,x,E){var z=new Image;z.crossOrigin="",z.onload=function(){E(null,{img:this,pos:_,size:x})},z.onerror=function(k){t.options.errorTileUrl!=""&&k.target.errorCheck===void 0?(k.target.errorCheck=!0,k.target.src=t.options.errorTileUrl):E(null,{img:P,pos:_,size:x})},z.src=o}function D(o,_){_.forEach(te),u(null,{canvas:d})}function te(o){s.drawImage(o.img,Math.floor(o.pos.x),Math.floor(o.pos.y),o.size,o.size)}}function O(t,u){var r=n.getPixelBounds(),d=n.getPixelOrigin(),s=document.createElement("canvas");s.width=l.x,s.height=l.y;var m=s.getContext("2d"),g=L.DomUtil.getPosition(t).subtract(r.min).add(d);try{m.drawImage(t,g.x,g.y,s.width-g.x*2,s.height-g.y*2),u(null,{canvas:s})}catch{console.error("Element could not be drawn on canvas",t)}}function Y(t,u){var r=document.createElement("canvas"),d=r.getContext("2d"),s=n.getPixelBounds(),m=new L.Point(s.min.x,s.min.y),g=n.project(t.getLatLng()),h=/^data\:/.test(t._icon.src),p=h?t._icon.src:M(t._icon.src),y=new Image,w=t.options.icon.options,c=w.iconSize,b=g.subtract(m),B=L.point(w.iconAnchor||c&&c.divideBy(2,!0));c instanceof L.Point&&(c=[c.x,c.y]);var j=Math.round(b.x-c[0]+B.x),D=Math.round(b.y-B.y);r.width=l.x,r.height=l.y,y.crossOrigin="",y.onload=function(){d.drawImage(this,j,D,c[0],c[1]),u(null,{canvas:r})},y.src=p,h&&y.onload()}function q(t,u){var r=document.createElement("canvas");r.width=l.x,r.height=l.y;var d=r.getContext("2d"),s=new Image;s.crossOrigin="",s.src=M(t._currentImage._image.src),s.onload=function(){d.drawImage(s,0,0),u(null,{canvas:r})}}function M(t){return ee(t)||t.indexOf("mapbox.com/styles/v1")!==-1?t:t+(t.match(/\?/)?"&":"?")+"cache="+i}function ee(t){var u=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i;return!!t.match(u)}},S}var F=de();const he=ie(F),_e=ae({__proto__:null,default:he},[F]);export{_e as i};
